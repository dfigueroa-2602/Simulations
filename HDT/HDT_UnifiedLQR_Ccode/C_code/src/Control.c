#include "stdafx.h"
#include "Control.h"

#define ConstMATH_PI        3.1415926535897932384626433832795
#define ConstMATH_SQRT3     1.7320508075688772935274463415059
#define ConstMATH_SQRT2     1.4142135623730950488016887242097

const float MATH_PI = ConstMATH_PI;
const float MATH_2PI = ConstMATH_PI * 2.0;
const float MATH_2PI_3 = ConstMATH_PI * 2.0 / 3.0;
const float MATH_PI_3 = ConstMATH_PI / 3.0;
const float MATH_1_2PI = 1.0 / (ConstMATH_PI * 2.0);
const float MATH_1_PI = 1.0 / ConstMATH_PI;
const float MATH_1_3 = 1.0 / 3.0;
const float MATH_1_SQRT3 = 1.0 / ConstMATH_SQRT3;
const float MATH_1_SQRT2 = 1.0 / ConstMATH_SQRT2;
const float MATH_SQRT2_3 = ConstMATH_SQRT2 / 3.0;
const float MATH_SQRT3_2 = ConstMATH_SQRT3 / 2.0;
const float MATH_SQRT2 = ConstMATH_SQRT2;
const float MATH_SQRT3 = ConstMATH_SQRT3;
const float MATH_1_2 = 1.0 / 2.0;
const float MATH_2_3 = 2.0 / 3.0;

/* Definition of the LQR controller void lqrControl(const double x[n. states], double u[n. inputs]) */
void lqrControl(const double x[10], const double xd[4], const double xr[32], double u[4])
{
    /* u = -K * x */
    u[0] = 0.0;
    u[1] = 0.0;
    u[2] = 0.0;
    u[3] = 0.0;
    
    /* For each state, assign each input as the multiplication of the column of that state times the state*/
    for (int nx = 0; nx < 10; ++nx) {
        u[0] -= Kx[0][nx] * x[nx];
        u[1] -= Kx[1][nx] * x[nx];
        u[2] -= Kx[2][nx] * x[nx];
        u[3] -= Kx[3][nx] * x[nx];
    }

    for (int nd = 0; nd < 4; ++nd) {
        u[0] -= Ku[0][nd] * xd[nd];
        u[1] -= Ku[1][nd] * xd[nd];
        u[2] -= Ku[2][nd] * xd[nd];
        u[3] -= Ku[3][nd] * xd[nd];
    }

    for (int nr = 0; nr < 32; ++nr) {
        u[0] -= Kr[0][nr] * xr[nr];
        u[1] -= Kr[1][nr] * xr[nr];
        u[2] -= Kr[2][nr] * xr[nr];
        u[3] -= Kr[3][nr] * xr[nr];
    }
}

void resonantSystem(const float e_k[4],
                    float rho_k[32],
                    float rho_k_1[32])
{
    rho_k_1[0] = Ard[0][0] * rho_k[0] + Ard[0][1] * rho_k[1] + Ard[0][2] * rho_k[2] + Ard[0][3] * rho_k[3] + Ard[0][4] * rho_k[4] + Ard[0][5] * rho_k[5] + Ard[0][6] * rho_k[6] + Ard[0][7] * rho_k[7] + Ard[0][8] * rho_k[8] + Ard[0][9] * rho_k[9] + Ard[0][10] * rho_k[10] + Ard[0][11] * rho_k[11] + Ard[0][12] * rho_k[12] + Ard[0][13] * rho_k[13] + Ard[0][14] * rho_k[14] + Ard[0][15] * rho_k[15] + Ard[0][16] * rho_k[16] + Ard[0][17] * rho_k[17] + Ard[0][18] * rho_k[18] + Ard[0][19] * rho_k[19] + Ard[0][20] * rho_k[20] + Ard[0][21] * rho_k[21] + Ard[0][22] * rho_k[22] + Ard[0][23] * rho_k[23] + Ard[0][24] * rho_k[24] + Ard[0][25] * rho_k[25] + Ard[0][26] * rho_k[26] + Ard[0][27] * rho_k[27] + Ard[0][28] * rho_k[28] + Ard[0][29] * rho_k[29] + Ard[0][30] * rho_k[30] + Ard[0][31] * rho_k[31] + Brd[0][0] * e_k[0] + Brd[0][1] * e_k[1] + Brd[0][2] * e_k[2] + Brd[0][3] * e_k[3];
    rho_k_1[1] = Ard[1][0] * rho_k[0] + Ard[1][1] * rho_k[1] + Ard[1][2] * rho_k[2] + Ard[1][3] * rho_k[3] + Ard[1][4] * rho_k[4] + Ard[1][5] * rho_k[5] + Ard[1][6] * rho_k[6] + Ard[1][7] * rho_k[7] + Ard[1][8] * rho_k[8] + Ard[1][9] * rho_k[9] + Ard[1][10] * rho_k[10] + Ard[1][11] * rho_k[11] + Ard[1][12] * rho_k[12] + Ard[1][13] * rho_k[13] + Ard[1][14] * rho_k[14] + Ard[1][15] * rho_k[15] + Ard[1][16] * rho_k[16] + Ard[1][17] * rho_k[17] + Ard[1][18] * rho_k[18] + Ard[1][19] * rho_k[19] + Ard[1][20] * rho_k[20] + Ard[1][21] * rho_k[21] + Ard[1][22] * rho_k[22] + Ard[1][23] * rho_k[23] + Ard[1][24] * rho_k[24] + Ard[1][25] * rho_k[25] + Ard[1][26] * rho_k[26] + Ard[1][27] * rho_k[27] + Ard[1][28] * rho_k[28] + Ard[1][29] * rho_k[29] + Ard[1][30] * rho_k[30] + Ard[1][31] * rho_k[31] + Brd[1][0] * e_k[0] + Brd[1][1] * e_k[1] + Brd[1][2] * e_k[2] + Brd[1][3] * e_k[3];
    rho_k_1[2] = Ard[2][0] * rho_k[0] + Ard[2][1] * rho_k[1] + Ard[2][2] * rho_k[2] + Ard[2][3] * rho_k[3] + Ard[2][4] * rho_k[4] + Ard[2][5] * rho_k[5] + Ard[2][6] * rho_k[6] + Ard[2][7] * rho_k[7] + Ard[2][8] * rho_k[8] + Ard[2][9] * rho_k[9] + Ard[2][10] * rho_k[10] + Ard[2][11] * rho_k[11] + Ard[2][12] * rho_k[12] + Ard[2][13] * rho_k[13] + Ard[2][14] * rho_k[14] + Ard[2][15] * rho_k[15] + Ard[2][16] * rho_k[16] + Ard[2][17] * rho_k[17] + Ard[2][18] * rho_k[18] + Ard[2][19] * rho_k[19] + Ard[2][20] * rho_k[20] + Ard[2][21] * rho_k[21] + Ard[2][22] * rho_k[22] + Ard[2][23] * rho_k[23] + Ard[2][24] * rho_k[24] + Ard[2][25] * rho_k[25] + Ard[2][26] * rho_k[26] + Ard[2][27] * rho_k[27] + Ard[2][28] * rho_k[28] + Ard[2][29] * rho_k[29] + Ard[2][30] * rho_k[30] + Ard[2][31] * rho_k[31] + Brd[2][0] * e_k[0] + Brd[2][1] * e_k[1] + Brd[2][2] * e_k[2] + Brd[2][3] * e_k[3];
    rho_k_1[3] = Ard[3][0] * rho_k[0] + Ard[3][1] * rho_k[1] + Ard[3][2] * rho_k[2] + Ard[3][3] * rho_k[3] + Ard[3][4] * rho_k[4] + Ard[3][5] * rho_k[5] + Ard[3][6] * rho_k[6] + Ard[3][7] * rho_k[7] + Ard[3][8] * rho_k[8] + Ard[3][9] * rho_k[9] + Ard[3][10] * rho_k[10] + Ard[3][11] * rho_k[11] + Ard[3][12] * rho_k[12] + Ard[3][13] * rho_k[13] + Ard[3][14] * rho_k[14] + Ard[3][15] * rho_k[15] + Ard[3][16] * rho_k[16] + Ard[3][17] * rho_k[17] + Ard[3][18] * rho_k[18] + Ard[3][19] * rho_k[19] + Ard[3][20] * rho_k[20] + Ard[3][21] * rho_k[21] + Ard[3][22] * rho_k[22] + Ard[3][23] * rho_k[23] + Ard[3][24] * rho_k[24] + Ard[3][25] * rho_k[25] + Ard[3][26] * rho_k[26] + Ard[3][27] * rho_k[27] + Ard[3][28] * rho_k[28] + Ard[3][29] * rho_k[29] + Ard[3][30] * rho_k[30] + Ard[3][31] * rho_k[31] + Brd[3][0] * e_k[0] + Brd[3][1] * e_k[1] + Brd[3][2] * e_k[2] + Brd[3][3] * e_k[3];
    rho_k_1[4] = Ard[4][0] * rho_k[0] + Ard[4][1] * rho_k[1] + Ard[4][2] * rho_k[2] + Ard[4][3] * rho_k[3] + Ard[4][4] * rho_k[4] + Ard[4][5] * rho_k[5] + Ard[4][6] * rho_k[6] + Ard[4][7] * rho_k[7] + Ard[4][8] * rho_k[8] + Ard[4][9] * rho_k[9] + Ard[4][10] * rho_k[10] + Ard[4][11] * rho_k[11] + Ard[4][12] * rho_k[12] + Ard[4][13] * rho_k[13] + Ard[4][14] * rho_k[14] + Ard[4][15] * rho_k[15] + Ard[4][16] * rho_k[16] + Ard[4][17] * rho_k[17] + Ard[4][18] * rho_k[18] + Ard[4][19] * rho_k[19] + Ard[4][20] * rho_k[20] + Ard[4][21] * rho_k[21] + Ard[4][22] * rho_k[22] + Ard[4][23] * rho_k[23] + Ard[4][24] * rho_k[24] + Ard[4][25] * rho_k[25] + Ard[4][26] * rho_k[26] + Ard[4][27] * rho_k[27] + Ard[4][28] * rho_k[28] + Ard[4][29] * rho_k[29] + Ard[4][30] * rho_k[30] + Ard[4][31] * rho_k[31] + Brd[4][0] * e_k[0] + Brd[4][1] * e_k[1] + Brd[4][2] * e_k[2] + Brd[4][3] * e_k[3];
    rho_k_1[5] = Ard[5][0] * rho_k[0] + Ard[5][1] * rho_k[1] + Ard[5][2] * rho_k[2] + Ard[5][3] * rho_k[3] + Ard[5][4] * rho_k[4] + Ard[5][5] * rho_k[5] + Ard[5][6] * rho_k[6] + Ard[5][7] * rho_k[7] + Ard[5][8] * rho_k[8] + Ard[5][9] * rho_k[9] + Ard[5][10] * rho_k[10] + Ard[5][11] * rho_k[11] + Ard[5][12] * rho_k[12] + Ard[5][13] * rho_k[13] + Ard[5][14] * rho_k[14] + Ard[5][15] * rho_k[15] + Ard[5][16] * rho_k[16] + Ard[5][17] * rho_k[17] + Ard[5][18] * rho_k[18] + Ard[5][19] * rho_k[19] + Ard[5][20] * rho_k[20] + Ard[5][21] * rho_k[21] + Ard[5][22] * rho_k[22] + Ard[5][23] * rho_k[23] + Ard[5][24] * rho_k[24] + Ard[5][25] * rho_k[25] + Ard[5][26] * rho_k[26] + Ard[5][27] * rho_k[27] + Ard[5][28] * rho_k[28] + Ard[5][29] * rho_k[29] + Ard[5][30] * rho_k[30] + Ard[5][31] * rho_k[31] + Brd[5][0] * e_k[0] + Brd[5][1] * e_k[1] + Brd[5][2] * e_k[2] + Brd[5][3] * e_k[3];
    rho_k_1[6] = Ard[6][0] * rho_k[0] + Ard[6][1] * rho_k[1] + Ard[6][2] * rho_k[2] + Ard[6][3] * rho_k[3] + Ard[6][4] * rho_k[4] + Ard[6][5] * rho_k[5] + Ard[6][6] * rho_k[6] + Ard[6][7] * rho_k[7] + Ard[6][8] * rho_k[8] + Ard[6][9] * rho_k[9] + Ard[6][10] * rho_k[10] + Ard[6][11] * rho_k[11] + Ard[6][12] * rho_k[12] + Ard[6][13] * rho_k[13] + Ard[6][14] * rho_k[14] + Ard[6][15] * rho_k[15] + Ard[6][16] * rho_k[16] + Ard[6][17] * rho_k[17] + Ard[6][18] * rho_k[18] + Ard[6][19] * rho_k[19] + Ard[6][20] * rho_k[20] + Ard[6][21] * rho_k[21] + Ard[6][22] * rho_k[22] + Ard[6][23] * rho_k[23] + Ard[6][24] * rho_k[24] + Ard[6][25] * rho_k[25] + Ard[6][26] * rho_k[26] + Ard[6][27] * rho_k[27] + Ard[6][28] * rho_k[28] + Ard[6][29] * rho_k[29] + Ard[6][30] * rho_k[30] + Ard[6][31] * rho_k[31] + Brd[6][0] * e_k[0] + Brd[6][1] * e_k[1] + Brd[6][2] * e_k[2] + Brd[6][3] * e_k[3];
    rho_k_1[7] = Ard[7][0] * rho_k[0] + Ard[7][1] * rho_k[1] + Ard[7][2] * rho_k[2] + Ard[7][3] * rho_k[3] + Ard[7][4] * rho_k[4] + Ard[7][5] * rho_k[5] + Ard[7][6] * rho_k[6] + Ard[7][7] * rho_k[7] + Ard[7][8] * rho_k[8] + Ard[7][9] * rho_k[9] + Ard[7][10] * rho_k[10] + Ard[7][11] * rho_k[11] + Ard[7][12] * rho_k[12] + Ard[7][13] * rho_k[13] + Ard[7][14] * rho_k[14] + Ard[7][15] * rho_k[15] + Ard[7][16] * rho_k[16] + Ard[7][17] * rho_k[17] + Ard[7][18] * rho_k[18] + Ard[7][19] * rho_k[19] + Ard[7][20] * rho_k[20] + Ard[7][21] * rho_k[21] + Ard[7][22] * rho_k[22] + Ard[7][23] * rho_k[23] + Ard[7][24] * rho_k[24] + Ard[7][25] * rho_k[25] + Ard[7][26] * rho_k[26] + Ard[7][27] * rho_k[27] + Ard[7][28] * rho_k[28] + Ard[7][29] * rho_k[29] + Ard[7][30] * rho_k[30] + Ard[7][31] * rho_k[31] + Brd[7][0] * e_k[0] + Brd[7][1] * e_k[1] + Brd[7][2] * e_k[2] + Brd[7][3] * e_k[3];
    rho_k_1[8] = Ard[8][0] * rho_k[0] + Ard[8][1] * rho_k[1] + Ard[8][2] * rho_k[2] + Ard[8][3] * rho_k[3] + Ard[8][4] * rho_k[4] + Ard[8][5] * rho_k[5] + Ard[8][6] * rho_k[6] + Ard[8][7] * rho_k[7] + Ard[8][8] * rho_k[8] + Ard[8][9] * rho_k[9] + Ard[8][10] * rho_k[10] + Ard[8][11] * rho_k[11] + Ard[8][12] * rho_k[12] + Ard[8][13] * rho_k[13] + Ard[8][14] * rho_k[14] + Ard[8][15] * rho_k[15] + Ard[8][16] * rho_k[16] + Ard[8][17] * rho_k[17] + Ard[8][18] * rho_k[18] + Ard[8][19] * rho_k[19] + Ard[8][20] * rho_k[20] + Ard[8][21] * rho_k[21] + Ard[8][22] * rho_k[22] + Ard[8][23] * rho_k[23] + Ard[8][24] * rho_k[24] + Ard[8][25] * rho_k[25] + Ard[8][26] * rho_k[26] + Ard[8][27] * rho_k[27] + Ard[8][28] * rho_k[28] + Ard[8][29] * rho_k[29] + Ard[8][30] * rho_k[30] + Ard[8][31] * rho_k[31] + Brd[8][0] * e_k[0] + Brd[8][1] * e_k[1] + Brd[8][2] * e_k[2] + Brd[8][3] * e_k[3];
    rho_k_1[9] = Ard[9][0] * rho_k[0] + Ard[9][1] * rho_k[1] + Ard[9][2] * rho_k[2] + Ard[9][3] * rho_k[3] + Ard[9][4] * rho_k[4] + Ard[9][5] * rho_k[5] + Ard[9][6] * rho_k[6] + Ard[9][7] * rho_k[7] + Ard[9][8] * rho_k[8] + Ard[9][9] * rho_k[9] + Ard[9][10] * rho_k[10] + Ard[9][11] * rho_k[11] + Ard[9][12] * rho_k[12] + Ard[9][13] * rho_k[13] + Ard[9][14] * rho_k[14] + Ard[9][15] * rho_k[15] + Ard[9][16] * rho_k[16] + Ard[9][17] * rho_k[17] + Ard[9][18] * rho_k[18] + Ard[9][19] * rho_k[19] + Ard[9][20] * rho_k[20] + Ard[9][21] * rho_k[21] + Ard[9][22] * rho_k[22] + Ard[9][23] * rho_k[23] + Ard[9][24] * rho_k[24] + Ard[9][25] * rho_k[25] + Ard[9][26] * rho_k[26] + Ard[9][27] * rho_k[27] + Ard[9][28] * rho_k[28] + Ard[9][29] * rho_k[29] + Ard[9][30] * rho_k[30] + Ard[9][31] * rho_k[31] + Brd[9][0] * e_k[0] + Brd[9][1] * e_k[1] + Brd[9][2] * e_k[2] + Brd[9][3] * e_k[3];
    rho_k_1[10] = Ard[10][0] * rho_k[0] + Ard[10][1] * rho_k[1] + Ard[10][2] * rho_k[2] + Ard[10][3] * rho_k[3] + Ard[10][4] * rho_k[4] + Ard[10][5] * rho_k[5] + Ard[10][6] * rho_k[6] + Ard[10][7] * rho_k[7] + Ard[10][8] * rho_k[8] + Ard[10][9] * rho_k[9] + Ard[10][10] * rho_k[10] + Ard[10][11] * rho_k[11] + Ard[10][12] * rho_k[12] + Ard[10][13] * rho_k[13] + Ard[10][14] * rho_k[14] + Ard[10][15] * rho_k[15] + Ard[10][16] * rho_k[16] + Ard[10][17] * rho_k[17] + Ard[10][18] * rho_k[18] + Ard[10][19] * rho_k[19] + Ard[10][20] * rho_k[20] + Ard[10][21] * rho_k[21] + Ard[10][22] * rho_k[22] + Ard[10][23] * rho_k[23] + Ard[10][24] * rho_k[24] + Ard[10][25] * rho_k[25] + Ard[10][26] * rho_k[26] + Ard[10][27] * rho_k[27] + Ard[10][28] * rho_k[28] + Ard[10][29] * rho_k[29] + Ard[10][30] * rho_k[30] + Ard[10][31] * rho_k[31] + Brd[10][0] * e_k[0] + Brd[10][1] * e_k[1] + Brd[10][2] * e_k[2] + Brd[10][3] * e_k[3];
    rho_k_1[11] = Ard[11][0] * rho_k[0] + Ard[11][1] * rho_k[1] + Ard[11][2] * rho_k[2] + Ard[11][3] * rho_k[3] + Ard[11][4] * rho_k[4] + Ard[11][5] * rho_k[5] + Ard[11][6] * rho_k[6] + Ard[11][7] * rho_k[7] + Ard[11][8] * rho_k[8] + Ard[11][9] * rho_k[9] + Ard[11][10] * rho_k[10] + Ard[11][11] * rho_k[11] + Ard[11][12] * rho_k[12] + Ard[11][13] * rho_k[13] + Ard[11][14] * rho_k[14] + Ard[11][15] * rho_k[15] + Ard[11][16] * rho_k[16] + Ard[11][17] * rho_k[17] + Ard[11][18] * rho_k[18] + Ard[11][19] * rho_k[19] + Ard[11][20] * rho_k[20] + Ard[11][21] * rho_k[21] + Ard[11][22] * rho_k[22] + Ard[11][23] * rho_k[23] + Ard[11][24] * rho_k[24] + Ard[11][25] * rho_k[25] + Ard[11][26] * rho_k[26] + Ard[11][27] * rho_k[27] + Ard[11][28] * rho_k[28] + Ard[11][29] * rho_k[29] + Ard[11][30] * rho_k[30] + Ard[11][31] * rho_k[31] + Brd[11][0] * e_k[0] + Brd[11][1] * e_k[1] + Brd[11][2] * e_k[2] + Brd[11][3] * e_k[3];
    rho_k_1[12] = Ard[12][0] * rho_k[0] + Ard[12][1] * rho_k[1] + Ard[12][2] * rho_k[2] + Ard[12][3] * rho_k[3] + Ard[12][4] * rho_k[4] + Ard[12][5] * rho_k[5] + Ard[12][6] * rho_k[6] + Ard[12][7] * rho_k[7] + Ard[12][8] * rho_k[8] + Ard[12][9] * rho_k[9] + Ard[12][10] * rho_k[10] + Ard[12][11] * rho_k[11] + Ard[12][12] * rho_k[12] + Ard[12][13] * rho_k[13] + Ard[12][14] * rho_k[14] + Ard[12][15] * rho_k[15] + Ard[12][16] * rho_k[16] + Ard[12][17] * rho_k[17] + Ard[12][18] * rho_k[18] + Ard[12][19] * rho_k[19] + Ard[12][20] * rho_k[20] + Ard[12][21] * rho_k[21] + Ard[12][22] * rho_k[22] + Ard[12][23] * rho_k[23] + Ard[12][24] * rho_k[24] + Ard[12][25] * rho_k[25] + Ard[12][26] * rho_k[26] + Ard[12][27] * rho_k[27] + Ard[12][28] * rho_k[28] + Ard[12][29] * rho_k[29] + Ard[12][30] * rho_k[30] + Ard[12][31] * rho_k[31] + Brd[12][0] * e_k[0] + Brd[12][1] * e_k[1] + Brd[12][2] * e_k[2] + Brd[12][3] * e_k[3];
    rho_k_1[13] = Ard[13][0] * rho_k[0] + Ard[13][1] * rho_k[1] + Ard[13][2] * rho_k[2] + Ard[13][3] * rho_k[3] + Ard[13][4] * rho_k[4] + Ard[13][5] * rho_k[5] + Ard[13][6] * rho_k[6] + Ard[13][7] * rho_k[7] + Ard[13][8] * rho_k[8] + Ard[13][9] * rho_k[9] + Ard[13][10] * rho_k[10] + Ard[13][11] * rho_k[11] + Ard[13][12] * rho_k[12] + Ard[13][13] * rho_k[13] + Ard[13][14] * rho_k[14] + Ard[13][15] * rho_k[15] + Ard[13][16] * rho_k[16] + Ard[13][17] * rho_k[17] + Ard[13][18] * rho_k[18] + Ard[13][19] * rho_k[19] + Ard[13][20] * rho_k[20] + Ard[13][21] * rho_k[21] + Ard[13][22] * rho_k[22] + Ard[13][23] * rho_k[23] + Ard[13][24] * rho_k[24] + Ard[13][25] * rho_k[25] + Ard[13][26] * rho_k[26] + Ard[13][27] * rho_k[27] + Ard[13][28] * rho_k[28] + Ard[13][29] * rho_k[29] + Ard[13][30] * rho_k[30] + Ard[13][31] * rho_k[31] + Brd[13][0] * e_k[0] + Brd[13][1] * e_k[1] + Brd[13][2] * e_k[2] + Brd[13][3] * e_k[3];
    rho_k_1[14] = Ard[14][0] * rho_k[0] + Ard[14][1] * rho_k[1] + Ard[14][2] * rho_k[2] + Ard[14][3] * rho_k[3] + Ard[14][4] * rho_k[4] + Ard[14][5] * rho_k[5] + Ard[14][6] * rho_k[6] + Ard[14][7] * rho_k[7] + Ard[14][8] * rho_k[8] + Ard[14][9] * rho_k[9] + Ard[14][10] * rho_k[10] + Ard[14][11] * rho_k[11] + Ard[14][12] * rho_k[12] + Ard[14][13] * rho_k[13] + Ard[14][14] * rho_k[14] + Ard[14][15] * rho_k[15] + Ard[14][16] * rho_k[16] + Ard[14][17] * rho_k[17] + Ard[14][18] * rho_k[18] + Ard[14][19] * rho_k[19] + Ard[14][20] * rho_k[20] + Ard[14][21] * rho_k[21] + Ard[14][22] * rho_k[22] + Ard[14][23] * rho_k[23] + Ard[14][24] * rho_k[24] + Ard[14][25] * rho_k[25] + Ard[14][26] * rho_k[26] + Ard[14][27] * rho_k[27] + Ard[14][28] * rho_k[28] + Ard[14][29] * rho_k[29] + Ard[14][30] * rho_k[30] + Ard[14][31] * rho_k[31] + Brd[14][0] * e_k[0] + Brd[14][1] * e_k[1] + Brd[14][2] * e_k[2] + Brd[14][3] * e_k[3];
    rho_k_1[15] = Ard[15][0] * rho_k[0] + Ard[15][1] * rho_k[1] + Ard[15][2] * rho_k[2] + Ard[15][3] * rho_k[3] + Ard[15][4] * rho_k[4] + Ard[15][5] * rho_k[5] + Ard[15][6] * rho_k[6] + Ard[15][7] * rho_k[7] + Ard[15][8] * rho_k[8] + Ard[15][9] * rho_k[9] + Ard[15][10] * rho_k[10] + Ard[15][11] * rho_k[11] + Ard[15][12] * rho_k[12] + Ard[15][13] * rho_k[13] + Ard[15][14] * rho_k[14] + Ard[15][15] * rho_k[15] + Ard[15][16] * rho_k[16] + Ard[15][17] * rho_k[17] + Ard[15][18] * rho_k[18] + Ard[15][19] * rho_k[19] + Ard[15][20] * rho_k[20] + Ard[15][21] * rho_k[21] + Ard[15][22] * rho_k[22] + Ard[15][23] * rho_k[23] + Ard[15][24] * rho_k[24] + Ard[15][25] * rho_k[25] + Ard[15][26] * rho_k[26] + Ard[15][27] * rho_k[27] + Ard[15][28] * rho_k[28] + Ard[15][29] * rho_k[29] + Ard[15][30] * rho_k[30] + Ard[15][31] * rho_k[31] + Brd[15][0] * e_k[0] + Brd[15][1] * e_k[1] + Brd[15][2] * e_k[2] + Brd[15][3] * e_k[3];
    rho_k_1[16] = Ard[16][0] * rho_k[0] + Ard[16][1] * rho_k[1] + Ard[16][2] * rho_k[2] + Ard[16][3] * rho_k[3] + Ard[16][4] * rho_k[4] + Ard[16][5] * rho_k[5] + Ard[16][6] * rho_k[6] + Ard[16][7] * rho_k[7] + Ard[16][8] * rho_k[8] + Ard[16][9] * rho_k[9] + Ard[16][10] * rho_k[10] + Ard[16][11] * rho_k[11] + Ard[16][12] * rho_k[12] + Ard[16][13] * rho_k[13] + Ard[16][14] * rho_k[14] + Ard[16][15] * rho_k[15] + Ard[16][16] * rho_k[16] + Ard[16][17] * rho_k[17] + Ard[16][18] * rho_k[18] + Ard[16][19] * rho_k[19] + Ard[16][20] * rho_k[20] + Ard[16][21] * rho_k[21] + Ard[16][22] * rho_k[22] + Ard[16][23] * rho_k[23] + Ard[16][24] * rho_k[24] + Ard[16][25] * rho_k[25] + Ard[16][26] * rho_k[26] + Ard[16][27] * rho_k[27] + Ard[16][28] * rho_k[28] + Ard[16][29] * rho_k[29] + Ard[16][30] * rho_k[30] + Ard[16][31] * rho_k[31] + Brd[16][0] * e_k[0] + Brd[16][1] * e_k[1] + Brd[16][2] * e_k[2] + Brd[16][3] * e_k[3];
    rho_k_1[17] = Ard[17][0] * rho_k[0] + Ard[17][1] * rho_k[1] + Ard[17][2] * rho_k[2] + Ard[17][3] * rho_k[3] + Ard[17][4] * rho_k[4] + Ard[17][5] * rho_k[5] + Ard[17][6] * rho_k[6] + Ard[17][7] * rho_k[7] + Ard[17][8] * rho_k[8] + Ard[17][9] * rho_k[9] + Ard[17][10] * rho_k[10] + Ard[17][11] * rho_k[11] + Ard[17][12] * rho_k[12] + Ard[17][13] * rho_k[13] + Ard[17][14] * rho_k[14] + Ard[17][15] * rho_k[15] + Ard[17][16] * rho_k[16] + Ard[17][17] * rho_k[17] + Ard[17][18] * rho_k[18] + Ard[17][19] * rho_k[19] + Ard[17][20] * rho_k[20] + Ard[17][21] * rho_k[21] + Ard[17][22] * rho_k[22] + Ard[17][23] * rho_k[23] + Ard[17][24] * rho_k[24] + Ard[17][25] * rho_k[25] + Ard[17][26] * rho_k[26] + Ard[17][27] * rho_k[27] + Ard[17][28] * rho_k[28] + Ard[17][29] * rho_k[29] + Ard[17][30] * rho_k[30] + Ard[17][31] * rho_k[31] + Brd[17][0] * e_k[0] + Brd[17][1] * e_k[1] + Brd[17][2] * e_k[2] + Brd[17][3] * e_k[3];
    rho_k_1[18] = Ard[18][0] * rho_k[0] + Ard[18][1] * rho_k[1] + Ard[18][2] * rho_k[2] + Ard[18][3] * rho_k[3] + Ard[18][4] * rho_k[4] + Ard[18][5] * rho_k[5] + Ard[18][6] * rho_k[6] + Ard[18][7] * rho_k[7] + Ard[18][8] * rho_k[8] + Ard[18][9] * rho_k[9] + Ard[18][10] * rho_k[10] + Ard[18][11] * rho_k[11] + Ard[18][12] * rho_k[12] + Ard[18][13] * rho_k[13] + Ard[18][14] * rho_k[14] + Ard[18][15] * rho_k[15] + Ard[18][16] * rho_k[16] + Ard[18][17] * rho_k[17] + Ard[18][18] * rho_k[18] + Ard[18][19] * rho_k[19] + Ard[18][20] * rho_k[20] + Ard[18][21] * rho_k[21] + Ard[18][22] * rho_k[22] + Ard[18][23] * rho_k[23] + Ard[18][24] * rho_k[24] + Ard[18][25] * rho_k[25] + Ard[18][26] * rho_k[26] + Ard[18][27] * rho_k[27] + Ard[18][28] * rho_k[28] + Ard[18][29] * rho_k[29] + Ard[18][30] * rho_k[30] + Ard[18][31] * rho_k[31] + Brd[18][0] * e_k[0] + Brd[18][1] * e_k[1] + Brd[18][2] * e_k[2] + Brd[18][3] * e_k[3];
    rho_k_1[19] = Ard[19][0] * rho_k[0] + Ard[19][1] * rho_k[1] + Ard[19][2] * rho_k[2] + Ard[19][3] * rho_k[3] + Ard[19][4] * rho_k[4] + Ard[19][5] * rho_k[5] + Ard[19][6] * rho_k[6] + Ard[19][7] * rho_k[7] + Ard[19][8] * rho_k[8] + Ard[19][9] * rho_k[9] + Ard[19][10] * rho_k[10] + Ard[19][11] * rho_k[11] + Ard[19][12] * rho_k[12] + Ard[19][13] * rho_k[13] + Ard[19][14] * rho_k[14] + Ard[19][15] * rho_k[15] + Ard[19][16] * rho_k[16] + Ard[19][17] * rho_k[17] + Ard[19][18] * rho_k[18] + Ard[19][19] * rho_k[19] + Ard[19][20] * rho_k[20] + Ard[19][21] * rho_k[21] + Ard[19][22] * rho_k[22] + Ard[19][23] * rho_k[23] + Ard[19][24] * rho_k[24] + Ard[19][25] * rho_k[25] + Ard[19][26] * rho_k[26] + Ard[19][27] * rho_k[27] + Ard[19][28] * rho_k[28] + Ard[19][29] * rho_k[29] + Ard[19][30] * rho_k[30] + Ard[19][31] * rho_k[31] + Brd[19][0] * e_k[0] + Brd[19][1] * e_k[1] + Brd[19][2] * e_k[2] + Brd[19][3] * e_k[3];
    rho_k_1[20] = Ard[20][0] * rho_k[0] + Ard[20][1] * rho_k[1] + Ard[20][2] * rho_k[2] + Ard[20][3] * rho_k[3] + Ard[20][4] * rho_k[4] + Ard[20][5] * rho_k[5] + Ard[20][6] * rho_k[6] + Ard[20][7] * rho_k[7] + Ard[20][8] * rho_k[8] + Ard[20][9] * rho_k[9] + Ard[20][10] * rho_k[10] + Ard[20][11] * rho_k[11] + Ard[20][12] * rho_k[12] + Ard[20][13] * rho_k[13] + Ard[20][14] * rho_k[14] + Ard[20][15] * rho_k[15] + Ard[20][16] * rho_k[16] + Ard[20][17] * rho_k[17] + Ard[20][18] * rho_k[18] + Ard[20][19] * rho_k[19] + Ard[20][20] * rho_k[20] + Ard[20][21] * rho_k[21] + Ard[20][22] * rho_k[22] + Ard[20][23] * rho_k[23] + Ard[20][24] * rho_k[24] + Ard[20][25] * rho_k[25] + Ard[20][26] * rho_k[26] + Ard[20][27] * rho_k[27] + Ard[20][28] * rho_k[28] + Ard[20][29] * rho_k[29] + Ard[20][30] * rho_k[30] + Ard[20][31] * rho_k[31] + Brd[20][0] * e_k[0] + Brd[20][1] * e_k[1] + Brd[20][2] * e_k[2] + Brd[20][3] * e_k[3];
    rho_k_1[21] = Ard[21][0] * rho_k[0] + Ard[21][1] * rho_k[1] + Ard[21][2] * rho_k[2] + Ard[21][3] * rho_k[3] + Ard[21][4] * rho_k[4] + Ard[21][5] * rho_k[5] + Ard[21][6] * rho_k[6] + Ard[21][7] * rho_k[7] + Ard[21][8] * rho_k[8] + Ard[21][9] * rho_k[9] + Ard[21][10] * rho_k[10] + Ard[21][11] * rho_k[11] + Ard[21][12] * rho_k[12] + Ard[21][13] * rho_k[13] + Ard[21][14] * rho_k[14] + Ard[21][15] * rho_k[15] + Ard[21][16] * rho_k[16] + Ard[21][17] * rho_k[17] + Ard[21][18] * rho_k[18] + Ard[21][19] * rho_k[19] + Ard[21][20] * rho_k[20] + Ard[21][21] * rho_k[21] + Ard[21][22] * rho_k[22] + Ard[21][23] * rho_k[23] + Ard[21][24] * rho_k[24] + Ard[21][25] * rho_k[25] + Ard[21][26] * rho_k[26] + Ard[21][27] * rho_k[27] + Ard[21][28] * rho_k[28] + Ard[21][29] * rho_k[29] + Ard[21][30] * rho_k[30] + Ard[21][31] * rho_k[31] + Brd[21][0] * e_k[0] + Brd[21][1] * e_k[1] + Brd[21][2] * e_k[2] + Brd[21][3] * e_k[3];
    rho_k_1[22] = Ard[22][0] * rho_k[0] + Ard[22][1] * rho_k[1] + Ard[22][2] * rho_k[2] + Ard[22][3] * rho_k[3] + Ard[22][4] * rho_k[4] + Ard[22][5] * rho_k[5] + Ard[22][6] * rho_k[6] + Ard[22][7] * rho_k[7] + Ard[22][8] * rho_k[8] + Ard[22][9] * rho_k[9] + Ard[22][10] * rho_k[10] + Ard[22][11] * rho_k[11] + Ard[22][12] * rho_k[12] + Ard[22][13] * rho_k[13] + Ard[22][14] * rho_k[14] + Ard[22][15] * rho_k[15] + Ard[22][16] * rho_k[16] + Ard[22][17] * rho_k[17] + Ard[22][18] * rho_k[18] + Ard[22][19] * rho_k[19] + Ard[22][20] * rho_k[20] + Ard[22][21] * rho_k[21] + Ard[22][22] * rho_k[22] + Ard[22][23] * rho_k[23] + Ard[22][24] * rho_k[24] + Ard[22][25] * rho_k[25] + Ard[22][26] * rho_k[26] + Ard[22][27] * rho_k[27] + Ard[22][28] * rho_k[28] + Ard[22][29] * rho_k[29] + Ard[22][30] * rho_k[30] + Ard[22][31] * rho_k[31] + Brd[22][0] * e_k[0] + Brd[22][1] * e_k[1] + Brd[22][2] * e_k[2] + Brd[22][3] * e_k[3];
    rho_k_1[23] = Ard[23][0] * rho_k[0] + Ard[23][1] * rho_k[1] + Ard[23][2] * rho_k[2] + Ard[23][3] * rho_k[3] + Ard[23][4] * rho_k[4] + Ard[23][5] * rho_k[5] + Ard[23][6] * rho_k[6] + Ard[23][7] * rho_k[7] + Ard[23][8] * rho_k[8] + Ard[23][9] * rho_k[9] + Ard[23][10] * rho_k[10] + Ard[23][11] * rho_k[11] + Ard[23][12] * rho_k[12] + Ard[23][13] * rho_k[13] + Ard[23][14] * rho_k[14] + Ard[23][15] * rho_k[15] + Ard[23][16] * rho_k[16] + Ard[23][17] * rho_k[17] + Ard[23][18] * rho_k[18] + Ard[23][19] * rho_k[19] + Ard[23][20] * rho_k[20] + Ard[23][21] * rho_k[21] + Ard[23][22] * rho_k[22] + Ard[23][23] * rho_k[23] + Ard[23][24] * rho_k[24] + Ard[23][25] * rho_k[25] + Ard[23][26] * rho_k[26] + Ard[23][27] * rho_k[27] + Ard[23][28] * rho_k[28] + Ard[23][29] * rho_k[29] + Ard[23][30] * rho_k[30] + Ard[23][31] * rho_k[31] + Brd[23][0] * e_k[0] + Brd[23][1] * e_k[1] + Brd[23][2] * e_k[2] + Brd[23][3] * e_k[3];
    rho_k_1[24] = Ard[24][0] * rho_k[0] + Ard[24][1] * rho_k[1] + Ard[24][2] * rho_k[2] + Ard[24][3] * rho_k[3] + Ard[24][4] * rho_k[4] + Ard[24][5] * rho_k[5] + Ard[24][6] * rho_k[6] + Ard[24][7] * rho_k[7] + Ard[24][8] * rho_k[8] + Ard[24][9] * rho_k[9] + Ard[24][10] * rho_k[10] + Ard[24][11] * rho_k[11] + Ard[24][12] * rho_k[12] + Ard[24][13] * rho_k[13] + Ard[24][14] * rho_k[14] + Ard[24][15] * rho_k[15] + Ard[24][16] * rho_k[16] + Ard[24][17] * rho_k[17] + Ard[24][18] * rho_k[18] + Ard[24][19] * rho_k[19] + Ard[24][20] * rho_k[20] + Ard[24][21] * rho_k[21] + Ard[24][22] * rho_k[22] + Ard[24][23] * rho_k[23] + Ard[24][24] * rho_k[24] + Ard[24][25] * rho_k[25] + Ard[24][26] * rho_k[26] + Ard[24][27] * rho_k[27] + Ard[24][28] * rho_k[28] + Ard[24][29] * rho_k[29] + Ard[24][30] * rho_k[30] + Ard[24][31] * rho_k[31] + Brd[24][0] * e_k[0] + Brd[24][1] * e_k[1] + Brd[24][2] * e_k[2] + Brd[24][3] * e_k[3];
    rho_k_1[25] = Ard[25][0] * rho_k[0] + Ard[25][1] * rho_k[1] + Ard[25][2] * rho_k[2] + Ard[25][3] * rho_k[3] + Ard[25][4] * rho_k[4] + Ard[25][5] * rho_k[5] + Ard[25][6] * rho_k[6] + Ard[25][7] * rho_k[7] + Ard[25][8] * rho_k[8] + Ard[25][9] * rho_k[9] + Ard[25][10] * rho_k[10] + Ard[25][11] * rho_k[11] + Ard[25][12] * rho_k[12] + Ard[25][13] * rho_k[13] + Ard[25][14] * rho_k[14] + Ard[25][15] * rho_k[15] + Ard[25][16] * rho_k[16] + Ard[25][17] * rho_k[17] + Ard[25][18] * rho_k[18] + Ard[25][19] * rho_k[19] + Ard[25][20] * rho_k[20] + Ard[25][21] * rho_k[21] + Ard[25][22] * rho_k[22] + Ard[25][23] * rho_k[23] + Ard[25][24] * rho_k[24] + Ard[25][25] * rho_k[25] + Ard[25][26] * rho_k[26] + Ard[25][27] * rho_k[27] + Ard[25][28] * rho_k[28] + Ard[25][29] * rho_k[29] + Ard[25][30] * rho_k[30] + Ard[25][31] * rho_k[31] + Brd[25][0] * e_k[0] + Brd[25][1] * e_k[1] + Brd[25][2] * e_k[2] + Brd[25][3] * e_k[3];
    rho_k_1[26] = Ard[26][0] * rho_k[0] + Ard[26][1] * rho_k[1] + Ard[26][2] * rho_k[2] + Ard[26][3] * rho_k[3] + Ard[26][4] * rho_k[4] + Ard[26][5] * rho_k[5] + Ard[26][6] * rho_k[6] + Ard[26][7] * rho_k[7] + Ard[26][8] * rho_k[8] + Ard[26][9] * rho_k[9] + Ard[26][10] * rho_k[10] + Ard[26][11] * rho_k[11] + Ard[26][12] * rho_k[12] + Ard[26][13] * rho_k[13] + Ard[26][14] * rho_k[14] + Ard[26][15] * rho_k[15] + Ard[26][16] * rho_k[16] + Ard[26][17] * rho_k[17] + Ard[26][18] * rho_k[18] + Ard[26][19] * rho_k[19] + Ard[26][20] * rho_k[20] + Ard[26][21] * rho_k[21] + Ard[26][22] * rho_k[22] + Ard[26][23] * rho_k[23] + Ard[26][24] * rho_k[24] + Ard[26][25] * rho_k[25] + Ard[26][26] * rho_k[26] + Ard[26][27] * rho_k[27] + Ard[26][28] * rho_k[28] + Ard[26][29] * rho_k[29] + Ard[26][30] * rho_k[30] + Ard[26][31] * rho_k[31] + Brd[26][0] * e_k[0] + Brd[26][1] * e_k[1] + Brd[26][2] * e_k[2] + Brd[26][3] * e_k[3];
    rho_k_1[27] = Ard[27][0] * rho_k[0] + Ard[27][1] * rho_k[1] + Ard[27][2] * rho_k[2] + Ard[27][3] * rho_k[3] + Ard[27][4] * rho_k[4] + Ard[27][5] * rho_k[5] + Ard[27][6] * rho_k[6] + Ard[27][7] * rho_k[7] + Ard[27][8] * rho_k[8] + Ard[27][9] * rho_k[9] + Ard[27][10] * rho_k[10] + Ard[27][11] * rho_k[11] + Ard[27][12] * rho_k[12] + Ard[27][13] * rho_k[13] + Ard[27][14] * rho_k[14] + Ard[27][15] * rho_k[15] + Ard[27][16] * rho_k[16] + Ard[27][17] * rho_k[17] + Ard[27][18] * rho_k[18] + Ard[27][19] * rho_k[19] + Ard[27][20] * rho_k[20] + Ard[27][21] * rho_k[21] + Ard[27][22] * rho_k[22] + Ard[27][23] * rho_k[23] + Ard[27][24] * rho_k[24] + Ard[27][25] * rho_k[25] + Ard[27][26] * rho_k[26] + Ard[27][27] * rho_k[27] + Ard[27][28] * rho_k[28] + Ard[27][29] * rho_k[29] + Ard[27][30] * rho_k[30] + Ard[27][31] * rho_k[31] + Brd[27][0] * e_k[0] + Brd[27][1] * e_k[1] + Brd[27][2] * e_k[2] + Brd[27][3] * e_k[3];
    rho_k_1[28] = Ard[28][0] * rho_k[0] + Ard[28][1] * rho_k[1] + Ard[28][2] * rho_k[2] + Ard[28][3] * rho_k[3] + Ard[28][4] * rho_k[4] + Ard[28][5] * rho_k[5] + Ard[28][6] * rho_k[6] + Ard[28][7] * rho_k[7] + Ard[28][8] * rho_k[8] + Ard[28][9] * rho_k[9] + Ard[28][10] * rho_k[10] + Ard[28][11] * rho_k[11] + Ard[28][12] * rho_k[12] + Ard[28][13] * rho_k[13] + Ard[28][14] * rho_k[14] + Ard[28][15] * rho_k[15] + Ard[28][16] * rho_k[16] + Ard[28][17] * rho_k[17] + Ard[28][18] * rho_k[18] + Ard[28][19] * rho_k[19] + Ard[28][20] * rho_k[20] + Ard[28][21] * rho_k[21] + Ard[28][22] * rho_k[22] + Ard[28][23] * rho_k[23] + Ard[28][24] * rho_k[24] + Ard[28][25] * rho_k[25] + Ard[28][26] * rho_k[26] + Ard[28][27] * rho_k[27] + Ard[28][28] * rho_k[28] + Ard[28][29] * rho_k[29] + Ard[28][30] * rho_k[30] + Ard[28][31] * rho_k[31] + Brd[28][0] * e_k[0] + Brd[28][1] * e_k[1] + Brd[28][2] * e_k[2] + Brd[28][3] * e_k[3];
    rho_k_1[29] = Ard[29][0] * rho_k[0] + Ard[29][1] * rho_k[1] + Ard[29][2] * rho_k[2] + Ard[29][3] * rho_k[3] + Ard[29][4] * rho_k[4] + Ard[29][5] * rho_k[5] + Ard[29][6] * rho_k[6] + Ard[29][7] * rho_k[7] + Ard[29][8] * rho_k[8] + Ard[29][9] * rho_k[9] + Ard[29][10] * rho_k[10] + Ard[29][11] * rho_k[11] + Ard[29][12] * rho_k[12] + Ard[29][13] * rho_k[13] + Ard[29][14] * rho_k[14] + Ard[29][15] * rho_k[15] + Ard[29][16] * rho_k[16] + Ard[29][17] * rho_k[17] + Ard[29][18] * rho_k[18] + Ard[29][19] * rho_k[19] + Ard[29][20] * rho_k[20] + Ard[29][21] * rho_k[21] + Ard[29][22] * rho_k[22] + Ard[29][23] * rho_k[23] + Ard[29][24] * rho_k[24] + Ard[29][25] * rho_k[25] + Ard[29][26] * rho_k[26] + Ard[29][27] * rho_k[27] + Ard[29][28] * rho_k[28] + Ard[29][29] * rho_k[29] + Ard[29][30] * rho_k[30] + Ard[29][31] * rho_k[31] + Brd[29][0] * e_k[0] + Brd[29][1] * e_k[1] + Brd[29][2] * e_k[2] + Brd[29][3] * e_k[3];
    rho_k_1[30] = Ard[30][0] * rho_k[0] + Ard[30][1] * rho_k[1] + Ard[30][2] * rho_k[2] + Ard[30][3] * rho_k[3] + Ard[30][4] * rho_k[4] + Ard[30][5] * rho_k[5] + Ard[30][6] * rho_k[6] + Ard[30][7] * rho_k[7] + Ard[30][8] * rho_k[8] + Ard[30][9] * rho_k[9] + Ard[30][10] * rho_k[10] + Ard[30][11] * rho_k[11] + Ard[30][12] * rho_k[12] + Ard[30][13] * rho_k[13] + Ard[30][14] * rho_k[14] + Ard[30][15] * rho_k[15] + Ard[30][16] * rho_k[16] + Ard[30][17] * rho_k[17] + Ard[30][18] * rho_k[18] + Ard[30][19] * rho_k[19] + Ard[30][20] * rho_k[20] + Ard[30][21] * rho_k[21] + Ard[30][22] * rho_k[22] + Ard[30][23] * rho_k[23] + Ard[30][24] * rho_k[24] + Ard[30][25] * rho_k[25] + Ard[30][26] * rho_k[26] + Ard[30][27] * rho_k[27] + Ard[30][28] * rho_k[28] + Ard[30][29] * rho_k[29] + Ard[30][30] * rho_k[30] + Ard[30][31] * rho_k[31] + Brd[30][0] * e_k[0] + Brd[30][1] * e_k[1] + Brd[30][2] * e_k[2] + Brd[30][3] * e_k[3];
    rho_k_1[31] = Ard[31][0] * rho_k[0] + Ard[31][1] * rho_k[1] + Ard[31][2] * rho_k[2] + Ard[31][3] * rho_k[3] + Ard[31][4] * rho_k[4] + Ard[31][5] * rho_k[5] + Ard[31][6] * rho_k[6] + Ard[31][7] * rho_k[7] + Ard[31][8] * rho_k[8] + Ard[31][9] * rho_k[9] + Ard[31][10] * rho_k[10] + Ard[31][11] * rho_k[11] + Ard[31][12] * rho_k[12] + Ard[31][13] * rho_k[13] + Ard[31][14] * rho_k[14] + Ard[31][15] * rho_k[15] + Ard[31][16] * rho_k[16] + Ard[31][17] * rho_k[17] + Ard[31][18] * rho_k[18] + Ard[31][19] * rho_k[19] + Ard[31][20] * rho_k[20] + Ard[31][21] * rho_k[21] + Ard[31][22] * rho_k[22] + Ard[31][23] * rho_k[23] + Ard[31][24] * rho_k[24] + Ard[31][25] * rho_k[25] + Ard[31][26] * rho_k[26] + Ard[31][27] * rho_k[27] + Ard[31][28] * rho_k[28] + Ard[31][29] * rho_k[29] + Ard[31][30] * rho_k[30] + Ard[31][31] * rho_k[31] + Brd[31][0] * e_k[0] + Brd[31][1] * e_k[1] + Brd[31][2] * e_k[2] + Brd[31][3] * e_k[3];
}

/* At the end of the Output loop, save the actual value as the last value*/
void variablesUpdate()
{
    var_Control_struct.States.u_k[0] = var_Control_struct.Output.ms_k_alphabeta.alpha;
    var_Control_struct.States.u_k[1] = var_Control_struct.Output.ms_k_alphabeta.beta;
    var_Control_struct.States.u_k[2] = var_Control_struct.Output.mp_k_alphabeta.alpha;
    var_Control_struct.States.u_k[3] = var_Control_struct.Output.mp_k_alphabeta.beta;

    var_Control_struct.States.rho_k[0] = var_Control_struct.States.rho_k_1[0];
    var_Control_struct.States.rho_k[1] = var_Control_struct.States.rho_k_1[1];
    var_Control_struct.States.rho_k[2] = var_Control_struct.States.rho_k_1[2];
    var_Control_struct.States.rho_k[3] = var_Control_struct.States.rho_k_1[3];
    var_Control_struct.States.rho_k[4] = var_Control_struct.States.rho_k_1[4];
    var_Control_struct.States.rho_k[5] = var_Control_struct.States.rho_k_1[5];
    var_Control_struct.States.rho_k[6] = var_Control_struct.States.rho_k_1[6];
    var_Control_struct.States.rho_k[7] = var_Control_struct.States.rho_k_1[7];
    var_Control_struct.States.rho_k[8] = var_Control_struct.States.rho_k_1[8];
    var_Control_struct.States.rho_k[9] = var_Control_struct.States.rho_k_1[9];
    var_Control_struct.States.rho_k[10] = var_Control_struct.States.rho_k_1[10];
    var_Control_struct.States.rho_k[11] = var_Control_struct.States.rho_k_1[11];
    var_Control_struct.States.rho_k[12] = var_Control_struct.States.rho_k_1[12];
    var_Control_struct.States.rho_k[13] = var_Control_struct.States.rho_k_1[13];
    var_Control_struct.States.rho_k[14] = var_Control_struct.States.rho_k_1[14];
    var_Control_struct.States.rho_k[15] = var_Control_struct.States.rho_k_1[15];
    var_Control_struct.States.rho_k[16] = var_Control_struct.States.rho_k_1[16];
    var_Control_struct.States.rho_k[17] = var_Control_struct.States.rho_k_1[17];
    var_Control_struct.States.rho_k[18] = var_Control_struct.States.rho_k_1[18];
    var_Control_struct.States.rho_k[19] = var_Control_struct.States.rho_k_1[19];
    var_Control_struct.States.rho_k[20] = var_Control_struct.States.rho_k_1[20];
    var_Control_struct.States.rho_k[21] = var_Control_struct.States.rho_k_1[21];
    var_Control_struct.States.rho_k[22] = var_Control_struct.States.rho_k_1[22];
    var_Control_struct.States.rho_k[23] = var_Control_struct.States.rho_k_1[23];
    var_Control_struct.States.rho_k[24] = var_Control_struct.States.rho_k_1[24];
    var_Control_struct.States.rho_k[25] = var_Control_struct.States.rho_k_1[25];
    var_Control_struct.States.rho_k[26] = var_Control_struct.States.rho_k_1[26];
    var_Control_struct.States.rho_k[27] = var_Control_struct.States.rho_k_1[27];
    var_Control_struct.States.rho_k[28] = var_Control_struct.States.rho_k_1[28];
    var_Control_struct.States.rho_k[29] = var_Control_struct.States.rho_k_1[29];
    var_Control_struct.States.rho_k[30] = var_Control_struct.States.rho_k_1[30];
    var_Control_struct.States.rho_k[31] = var_Control_struct.States.rho_k_1[31];
}